<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Simulaci√≥n: Trazador de Paths</title>
    <style>
        body { font-family: monospace; background: #333; color: white; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .canvas-area { position: relative; cursor: crosshair; background: white; width: 400px; height: 400px; border-radius: 4px; }
        .controls { width: 400px; margin-top: 10px; display: flex; gap: 10px; }
        button { padding: 10px; flex: 1; cursor: pointer; font-weight: bold; border: none; border-radius: 4px; }
        .btn-green { background: #2ecc71; color: white; }
        .btn-red { background: #e74c3c; color: white; }
        .btn-blue { background: #3498db; color: white; }
        
        #path-code { background: #222; color: #a6e22e; padding: 20px; margin-top: 20px; width: 400px; min-height: 50px; font-size: 1.2rem; border-radius: 4px; word-break: break-all; }
        
        .point { position: absolute; width: 8px; height: 8px; background: red; border-radius: 50%; transform: translate(-50%, -50%); pointer-events: none; }
    </style>
</head>
<body>
    <h1>üñãÔ∏è El Trazador "Path"</h1>
    <p>Haz clic para a√±adir puntos. Usa los botones para cerrar o limpiar.</p>

    <div class="canvas-area" id="canvas">
        <svg width="100%" height="100%" style="position: absolute; top:0; left:0; pointer-events: none;">
            <path id="current-path" d="" fill="none" stroke="#2c3e50" stroke-width="3" />
            <path id="preview-line" d="" fill="none" stroke="red" stroke-width="1" stroke-dasharray="5,5" />
        </svg>
    </div>

    <div class="controls">
        <button class="btn-blue" onclick="closePath()">Cerrar Ruta (Z)</button>
        <button class="btn-red" onclick="reset()">Limpiar</button>
    </div>

    <div id="path-code">&lt;path d="" /&gt;</div>

    <script>
        const canvas = document.getElementById('canvas');
        const pathEl = document.getElementById('current-path');
        const previewEl = document.getElementById('preview-line');
        const codeDisplay = document.getElementById('path-code');
        
        let points = [];
        let isClosed = false;

        function updateCode() {
            if (points.length === 0) {
                codeDisplay.textContent = '<path d="" />';
                pathEl.setAttribute('d', '');
                return;
            }

            let d = `M ${points[0].x} ${points[0].y}`;
            for(let i=1; i<points.length; i++) {
                d += ` L ${points[i].x} ${points[i].y}`;
            }
            if (isClosed) d += ' Z';

            pathEl.setAttribute('d', d);
            
            // Fill if closed
            if (isClosed) pathEl.setAttribute('fill', '#3498db55');
            else pathEl.setAttribute('fill', 'none');

            codeDisplay.textContent = `<path d="${d}" />`;
        }

        canvas.addEventListener('click', (e) => {
            if(isClosed) return;

            const rect = canvas.getBoundingClientRect();
            const x = Math.round(e.clientX - rect.left);
            const y = Math.round(e.clientY - rect.top);

            points.push({x, y});

            // Visual marker
            const dot = document.createElement('div');
            dot.className = 'point';
            dot.style.left = x + 'px';
            dot.style.top = y + 'px';
            canvas.appendChild(dot);

            updateCode();
        });

        canvas.addEventListener('mousemove', (e) => {
            if (points.length === 0 || isClosed) {
                previewEl.setAttribute('d', '');
                return;
            }
            const rect = canvas.getBoundingClientRect();
            const x = Math.round(e.clientX - rect.left);
            const y = Math.round(e.clientY - rect.top);
            
            const last = points[points.length-1];
            previewEl.setAttribute('d', `M ${last.x} ${last.y} L ${x} ${y}`);
        });

        function closePath() {
            if (points.length < 3) {
                alert("Necesitas al menos 3 puntos para cerrar una forma.");
                return;
            }
            isClosed = true;
            previewEl.setAttribute('d', '');
            updateCode();
        }

        function reset() {
            points = [];
            isClosed = false;
            pathEl.setAttribute('d', '');
            previewEl.setAttribute('d', '');
            
            // Remove dots
            const dots = document.querySelectorAll('.point');
            dots.forEach(d => d.remove());
            
            updateCode();
        }
    </script>
</body>
</html>
